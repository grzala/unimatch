<div class="row" id="user_info">
<div class="col-md-2">
    <%= image_tag @user.avatar_url(:display), :id => "profile_image" %>
</div>
<div class="col-md-3">
    <div class="left" id="user_details">
    <h2 class="inline_block_user"><%= @user.name %></h2>
    <% if session[:user_id] == @user.id %>
    <p><%= link_to 'Edit these details', controller: 'user', action: 'edit', id: @user.id %></p>
    <p><%= link_to 'Edit Choices', controller: 'user', action: 'choose_interests', id: @user.id %></p>
    <% end %>
    </div>
</div>
<div class="col-md-3">
    <div class="left" id="percentage">
    <p>Percentage Match: </p>

    </div>
</div>
</div>
<div class="row">
<div class="col-md-8">
    <h4 class="left">Similar Interests</h4>
</div>
<div class="col-md-4" class="left">
    <% if session[:user_id] != @user.id %>
    <h4>Attending Events</h4>
    <% if @events.length == 0 %>
    <p>Not attending any events</p>
    <% else %>
    <% @events.each do |event| %>
    <%= link_to event.name :controller => :event, :action => :show, :id => event.id %>
    <% end %>
    <% end %>
    <% end %>
    <h4>In Societies</h4>
    <% if @in_societies.length == 0 %>
    <p>Not in any societies</p>
    <% else %>
    <% @in_societies.each do %>
    <%= link_to society.name :controller => :society, :action => :show, :id => society.id %>
    <% end %>
    <% end %>
</div>
</div>
<div class="row">
<div class="col-md-8">
<% if session[:user_id] == @user.id %>
<div id='calendar-wrapper' style='width: 100%; margin-right:auto; margin-left: auto'>
    <div id='calendar'>
    </div>
</div>
<% else %>
<h4 class="left">Your conversation with <%= @user.name %></h4>
<% end %>
</div>
</div>   
<script>
$(document).ready(function() {

    function render(event, element) {
        console.log("RENDER");
        element.find('.fc-content').append('<div class="fc-separator"></div><p class="fc-description">'+ event.description + '</p></div>');
    }
    
    $('#calendar').fullCalendar({
        header: {
            left: 'prev',
            center: 'title',
            right: 'next',
        },
		defaultView: 'basicWeek',
		height: 500,
        timeFormat: 'H(:mm)', // uppercase H for 24-hour clock
        
        
		
		events: <%= @events_json %>,
		
	    eventRender: render,
    });
    
    
});
</script>

<% if !@con.nil? %>
    <div class="messages">
        
    </div>
    
    <script>
        var CON_ID = <%= @con.id %>
        $(document).ready(function() {
            $('.messages').messages(CON_ID);
        })
    </script>
<% end %>
